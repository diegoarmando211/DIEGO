<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prueba - Calculadora de F√≠sica</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f8f9fa;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-title {
            color: #2c3e50;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        .success { color: #27ae60; }
        .error { color: #e74c3c; }
        .info { color: #3498db; }
        button {
            background: #3498db;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #2980b9;
        }
        .result {
            background: #ecf0f1;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <h1>üß™ Prueba de la Calculadora de F√≠sica</h1>
    <p>Esta p√°gina te permite probar los componentes principales de la calculadora antes de usar la aplicaci√≥n completa.</p>

    <div class="test-section">
        <h2 class="test-title">1. Prueba de C√°lculos B√°sicos</h2>
        <p>Prueba las f√≥rmulas f√≠sicas implementadas:</p>
        
        <button onclick="testEnergiaCinetica()">Probar Energ√≠a Cin√©tica</button>
        <button onclick="testEnergiaPotencial()">Probar Energ√≠a Potencial</button>
        <button onclick="testTrabajo()">Probar Trabajo</button>
        <button onclick="testPotencia()">Probar Potencia</button>
        
        <div id="calculationResults" class="result" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h2 class="test-title">2. Prueba de Base de Datos (Simulador)</h2>
        <p>Verifica que el simulador de base de datos funcione:</p>
        
        <button onclick="testDatabase()">Probar Conexi√≥n DB</button>
        <button onclick="loadEscenarios()">Cargar Escenarios</button>
        <button onclick="saveTestCalculo()">Guardar C√°lculo de Prueba</button>
        
        <div id="databaseResults" class="result" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h2 class="test-title">3. Prueba de Validaciones</h2>
        <p>Verifica que las validaciones de par√°metros funcionen:</p>
        
        <button onclick="testValidations()">Probar Validaciones</button>
        
        <div id="validationResults" class="result" style="display: none;"></div>
    </div>

    <div class="test-section">
        <h2 class="test-title">4. Ver Im√°genes de Escenarios</h2>
        <p>Verifica que las im√°genes SVG se muestren correctamente:</p>
        
        <button onclick="showImages()">Mostrar Im√°genes</button>
        
        <div id="imageResults" style="display: none;">
            <h3>Trabajo con √Ångulo:</h3>
            <img src="images/trabajo_angulo.svg" alt="Trabajo con √°ngulo" style="max-width: 100%; border: 1px solid #ddd;">
            
            <h3>Energ√≠a Cin√©tica:</h3>
            <img src="images/energia_cinetica.svg" alt="Energ√≠a cin√©tica" style="max-width: 100%; border: 1px solid #ddd;">
            
            <h3>Energ√≠a Potencial:</h3>
            <img src="images/energia_potencial.svg" alt="Energ√≠a potencial" style="max-width: 100%; border: 1px solid #ddd;">
            
            <h3>Trabajo Simple:</h3>
            <img src="images/trabajo_simple.svg" alt="Trabajo simple" style="max-width: 100%; border: 1px solid #ddd;">
        </div>
    </div>

    <div class="test-section">
        <h2 class="test-title">5. Ir a la Aplicaci√≥n Completa</h2>
        <p>Si todas las pruebas funcionan correctamente:</p>
        <a href="index.html" style="display: inline-block; background: #27ae60; color: white; padding: 15px 30px; text-decoration: none; border-radius: 5px; font-weight: bold;">
            üöÄ Abrir Calculadora Completa
        </a>
    </div>

    <!-- Cargar los scripts necesarios -->
    <script src="js/database.js"></script>
    <script src="js/calculations.js"></script>

    <script>
        // Funci√≥n para mostrar resultados
        function showResult(elementId, content, type = 'info') {
            const element = document.getElementById(elementId);
            element.style.display = 'block';
            element.innerHTML = `<div class="${type}">${content}</div>`;
        }

        // Prueba de energ√≠a cin√©tica
        function testEnergiaCinetica() {
            try {
                const result = physicsCalculator.calcularEnergiaCinetica(10, 5); // 10 kg, 5 m/s
                showResult('calculationResults', `
                    <strong>‚úÖ Energ√≠a Cin√©tica:</strong><br>
                    Masa: 10 kg, Velocidad: 5 m/s<br>
                    Resultado: ${result.resultado} J<br>
                    Explicaci√≥n: ${result.explicacion}<br>
                    <strong>Pasos:</strong><br>
                    ${result.pasos.map(paso => `‚Ä¢ ${paso}`).join('<br>')}
                `, 'success');
            } catch (error) {
                showResult('calculationResults', `‚ùå Error: ${error.message}`, 'error');
            }
        }

        // Prueba de energ√≠a potencial
        function testEnergiaPotencial() {
            try {
                const result = physicsCalculator.calcularEnergiaPotencial(5, 10); // 5 kg, 10 m
                showResult('calculationResults', `
                    <strong>‚úÖ Energ√≠a Potencial:</strong><br>
                    Masa: 5 kg, Altura: 10 m<br>
                    Resultado: ${result.resultado} J<br>
                    Explicaci√≥n: ${result.explicacion}<br>
                    <strong>Pasos:</strong><br>
                    ${result.pasos.map(paso => `‚Ä¢ ${paso}`).join('<br>')}
                `, 'success');
            } catch (error) {
                showResult('calculationResults', `‚ùå Error: ${error.message}`, 'error');
            }
        }

        // Prueba de trabajo
        function testTrabajo() {
            try {
                const result = physicsCalculator.calcularTrabajoConAngulo(100, 5, 30); // 100 N, 5 m, 30¬∞
                showResult('calculationResults', `
                    <strong>‚úÖ Trabajo con √Ångulo:</strong><br>
                    Fuerza: 100 N, Distancia: 5 m, √Ångulo: 30¬∞<br>
                    Resultado: ${result.resultado} J<br>
                    Explicaci√≥n: ${result.explicacion}<br>
                    <strong>Pasos:</strong><br>
                    ${result.pasos.map(paso => `‚Ä¢ ${paso}`).join('<br>')}
                `, 'success');
            } catch (error) {
                showResult('calculationResults', `‚ùå Error: ${error.message}`, 'error');
            }
        }

        // Prueba de potencia
        function testPotencia() {
            try {
                const result = physicsCalculator.calcularPotencia(50, 10, 5, 0); // 50 N, 10 m, 5 s, 0¬∞
                showResult('calculationResults', `
                    <strong>‚úÖ Potencia:</strong><br>
                    Fuerza: 50 N, Distancia: 10 m, Tiempo: 5 s, √Ångulo: 0¬∞<br>
                    Resultado: ${result.resultado} W<br>
                    Explicaci√≥n: ${result.explicacion}<br>
                    <strong>Pasos:</strong><br>
                    ${result.pasos.map(paso => `‚Ä¢ ${paso}`).join('<br>')}
                `, 'success');
            } catch (error) {
                showResult('calculationResults', `‚ùå Error: ${error.message}`, 'error');
            }
        }

        // Prueba de base de datos
        async function testDatabase() {
            try {
                const escenarios = await dbManager.getEscenarios();
                showResult('databaseResults', `
                    <strong>‚úÖ Conexi√≥n a Base de Datos:</strong><br>
                    Se cargaron ${escenarios.length} escenarios correctamente<br>
                    <strong>Escenarios disponibles:</strong><br>
                    ${escenarios.map(e => `‚Ä¢ ${e.Nombre} (${e.Codigo})`).join('<br>')}
                `, 'success');
            } catch (error) {
                showResult('databaseResults', `‚ùå Error de DB: ${error.message}`, 'error');
            }
        }

        // Cargar escenarios
        async function loadEscenarios() {
            try {
                const escenario = await dbManager.getEscenarioById(5); // Energ√≠a cin√©tica
                showResult('databaseResults', `
                    <strong>‚úÖ Escenario Cargado:</strong><br>
                    Nombre: ${escenario.Nombre}<br>
                    F√≥rmula: ${escenario.FormulaDescripcion}<br>
                    Unidad: ${escenario.UnidadResultado}<br>
                    <strong>Par√°metros:</strong><br>
                    ${escenario.parametros.map(p => `‚Ä¢ ${p.Nombre} (${p.Unidad})`).join('<br>')}
                `, 'success');
            } catch (error) {
                showResult('databaseResults', `‚ùå Error: ${error.message}`, 'error');
            }
        }

        // Guardar c√°lculo de prueba
        async function saveTestCalculo() {
            try {
                const calculoData = {
                    EscenarioID: 5,
                    EscenarioNombre: 'Energ√≠a cin√©tica (PRUEBA)',
                    Resultado: 125,
                    UnidadResultado: 'J',
                    Parametros: { m: 10, v: 5 }
                };
                
                const result = await dbManager.saveCalculo(calculoData);
                showResult('databaseResults', `
                    <strong>‚úÖ C√°lculo Guardado:</strong><br>
                    ID: ${result.CalculoID}<br>
                    Fecha: ${new Date(result.Fecha).toLocaleString()}<br>
                    Resultado: ${result.Resultado} ${result.UnidadResultado}
                `, 'success');
            } catch (error) {
                showResult('databaseResults', `‚ùå Error al guardar: ${error.message}`, 'error');
            }
        }

        // Prueba de validaciones
        function testValidations() {
            try {
                // Crear un escenario de prueba
                const escenario = {
                    parametros: [
                        { Codigo: 'm', Nombre: 'Masa (kg)' },
                        { Codigo: 'v', Nombre: 'Velocidad (m/s)' },
                        { Codigo: 't', Nombre: 'Tiempo (s)' }
                    ]
                };

                // Probar par√°metros v√°lidos
                const validParams = { m: 10, v: 5, t: 2 };
                const validErrors = physicsCalculator.validarParametros(escenario, validParams);

                // Probar par√°metros inv√°lidos
                const invalidParams = { m: -5, v: 'abc', t: 0 };
                const invalidErrors = physicsCalculator.validarParametros(escenario, invalidParams);

                showResult('validationResults', `
                    <strong>‚úÖ Validaciones:</strong><br>
                    <strong>Par√°metros v√°lidos:</strong> ${validErrors.length === 0 ? '‚úì Ning√∫n error' : '‚úó ' + validErrors.join(', ')}<br>
                    <strong>Par√°metros inv√°lidos:</strong><br>
                    ${invalidErrors.length > 0 ? invalidErrors.map(err => `‚Ä¢ ${err}`).join('<br>') : '‚úó No se detectaron errores (problema)'}
                `, validErrors.length === 0 && invalidErrors.length > 0 ? 'success' : 'error');
            } catch (error) {
                showResult('validationResults', `‚ùå Error en validaciones: ${error.message}`, 'error');
            }
        }

        // Mostrar im√°genes
        function showImages() {
            const imageResults = document.getElementById('imageResults');
            imageResults.style.display = 'block';
        }

        // Ejecutar prueba inicial
        window.addEventListener('load', () => {
            console.log('üß™ P√°gina de pruebas cargada');
            console.log('üì¶ Componentes disponibles:', {
                dbManager: typeof dbManager !== 'undefined',
                physicsCalculator: typeof physicsCalculator !== 'undefined'
            });
        });
    </script>
</body>
</html>